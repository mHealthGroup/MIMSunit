<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Aggregate over epoch to get numerically integrated values. — aggregate_for_mims • MIMSunit</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate over epoch to get numerically integrated values. — aggregate_for_mims"><meta property="og:description" content="aggregate_for_mims returns a dataframe with integrated values by
trapzoidal method over each epoch for each column. The epoch start time will
be used as timestamp in the first column."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-38342303-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-38342303-3');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MIMSunit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.11.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Get Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mims_unit_from_files.html">Compute MIMS-unit from files</a>
    </li>
    <li>
      <a href="../articles/mims_unit_from_imported_data.html">Compute MIMS-unit from imported data</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/datasets.html">Datasets</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Algorithm Walkthrough
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/conceptual_diagram.html">Step-by-step illustration</a>
    </li>
    <li>
      <a href="../articles/truncation_threshold.html">Deciding truncation threshold</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Performances
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cross_device_consistency.html">Cross device consistency</a>
    </li>
    <li>
      <a href="../articles/edge_cases.html">Performance under edge conditions</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">API References</a>
</li>
<li>
  <a href="../news/index.html">Changelogs</a>
</li>
<li>
  <a href="../articles/faq.html">FAQs</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mhealthgroup/mimsunit" class="external-link">
    <span class="fa fa-lg fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregate over epoch to get numerically integrated values.</h1>
    <small class="dont-index">Source: <a href="https://github.com/mhealthgroup/MIMSunit/blob/HEAD/R/aggregate_over_epoch.R" class="external-link"><code>R/aggregate_over_epoch.R</code></a></small>
    <div class="hidden name"><code>aggregate_for_mims.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>aggregate_for_mims</code> returns a dataframe with integrated values by
trapzoidal method over each epoch for each column. The epoch start time will
be used as timestamp in the first column.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">aggregate_for_mims</span><span class="op">(</span>
  <span class="va">df</span>,
  <span class="va">epoch</span>,
  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trapz"</span>, <span class="st">"power"</span>, <span class="st">"mean_by_time"</span>, <span class="st">"mean_by_size"</span>, <span class="st">"sum"</span><span class="op">)</span>,
  rectify <span class="op">=</span> <span class="cn">TRUE</span>,
  st <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>dataframe of accelerometer data in mhealth format. First column
should be timestamps in POSIXt format.</p></dd>


<dt>epoch</dt>
<dd><p>string. Any format that is acceptable by argument <code>breaks</code>
in method <code><a href="https://rdrr.io/r/base/cut.POSIXt.html" class="external-link">cut.POSIXt</a></code>.For example, "1 sec", "1 min", "5
secs", "10 mins".</p></dd>


<dt>method</dt>
<dd><p>string. Integration methods. Supported strings include:
"trapz", "power", "sum", "meanBySecond", "meanBySize". Default is "trapz".</p></dd>


<dt>rectify</dt>
<dd><p>logical. If TRUE, input data will be rectified before
integration. Default is TRUE.</p></dd>


<dt>st</dt>
<dd><p>character or POSIXct timestamp. An optional start time you can set to
force the epochs generated by referencing this start time. If it is NULL, the
function will use the first timestamp in the timestamp column as start time to
generate epochs. This is useful when you are processing a stream of data and
want to use a common start time for segmenting data. Default is NULL.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>dataframe. The returned dataframe will have the same format as input
  dataframe.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function accepts a dataframe (in mhealth accelerometer data format) and
computes its aggregated values over each fixed epoch using different
integration methods (default is trapzoidal method, other methods are not used
by mims unit algorithm) for each value columns. The returned dataframe will
have the same number of columns as input dataframe, and have the same
datetime format as input dataframe in the timestamp column. The trapzoidal
method used in the function is based on <code><a href="https://rdrr.io/pkg/caTools/man/trapz.html" class="external-link">trapz</a></code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>If <code>epoch</code> argument is not provided or is <code>NULL</code>, the
  function will treat the input dataframe as a single epoch.</p>
<p>If the number of samples in one segment is less than 90<!-- % of the expected -->
  samples, the aggregation result will be -1 (marker of invalid value).</p>
    </div>
    <div id="how-is-it-used-in-mims-unit-algorithm-">
    <h2>How is it used in mims-unit algorithm?</h2>
    <p>This function is used in
  mims-unit algorithm after filtering (<code><a href="iir.html">iir</a></code>). The filtered
  signal will be rectified and integrated to get mims unit values for each
  axis using this function.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="aggregate_for_orientation.html">aggregate_for_orientation</a></code> for aggregating to get
  accelerometer orientation estimation for each epoch.</p>
<p>Other aggregate functions: 
<code><a href="aggregate_for_orientation.html">aggregate_for_orientation</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in">  <span class="co"># sample data</span></span>
<span class="r-in">  <span class="va">df</span> <span class="op">=</span> <span class="va">sample_raw_accel_data</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     HEADER_TIME_STAMP     X      Y      Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2016-01-15 11:00:00 0.148 -0.438  0.016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2016-01-15 11:00:00 0.215 -0.418 -0.023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2016-01-15 11:00:00 0.266 -0.402 -0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2016-01-15 11:00:00 0.336 -0.430  0.012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2016-01-15 11:00:00 0.430 -0.320  0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2016-01-15 11:00:00 0.535 -0.258  0.004</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># epoch set to 5 seconds, and method set to "trapz"</span></span>
<span class="r-in">  <span class="fu">aggregate_for_mims</span><span class="op">(</span><span class="va">df</span>, epoch <span class="op">=</span> <span class="st">'5 sec'</span>, method<span class="op">=</span><span class="st">'trapz'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     HEADER_TIME_STAMP AGGREGATED_X AGGREGATED_Y AGGREGATED_Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2016-01-15 11:00:00     6.359663     2.420398      1.62992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2016-01-15 11:00:05    -1.000000    -1.000000     -1.00000</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># epoch set to 1 second, method set to "sum"</span></span>
<span class="r-in">  <span class="fu">aggregate_for_mims</span><span class="op">(</span><span class="va">df</span>, epoch <span class="op">=</span> <span class="st">'1 sec'</span>, method<span class="op">=</span><span class="st">'sum'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      HEADER_TIME_STAMP AGGREGATED_auc_values AGGREGATED_X AGGREGATED_Y  Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2016-01-15 11:00:00                99.542           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2016-01-15 11:00:00                34.291           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2016-01-15 11:00:00                22.296           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2016-01-15 11:00:01                97.332           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2016-01-15 11:00:01                36.783           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2016-01-15 11:00:01                25.970           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2016-01-15 11:00:02               104.054           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2016-01-15 11:00:02                42.027           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2016-01-15 11:00:02                27.141           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2016-01-15 11:00:03               104.749           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2016-01-15 11:00:03                39.400           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2016-01-15 11:00:03                26.702           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2016-01-15 11:00:04               103.642           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2016-01-15 11:00:04                41.445           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2016-01-15 11:00:04                28.518           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2016-01-15 11:00:05               100.172           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2016-01-15 11:00:05                28.005           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2016-01-15 11:00:05                21.359           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2016-01-15 11:00:06                    NA           -1           -1 -1</span>
<span class="r-in"></span>
<span class="r-in">  <span class="co"># epoch set to 1 second, and st set to be 1 second before the start time of the data</span></span>
<span class="r-in">  <span class="co"># so the first segment will only include data for 1 second, therefore the resulted</span></span>
<span class="r-in">  <span class="co"># aggregated value for the first segment will be -1 (invalid) because the</span></span>
<span class="r-in">  <span class="co"># samples are not enough. And the second segment starts from 11:00:01, instead</span></span>
<span class="r-in">  <span class="co"># of 11:00:02 as shown in prior example,</span></span>
<span class="r-in">  <span class="fu">aggregate_for_mims</span><span class="op">(</span><span class="va">df</span>, epoch <span class="op">=</span> <span class="st">'1 sec'</span>, method<span class="op">=</span><span class="st">'sum'</span>, st<span class="op">=</span><span class="va">df</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      HEADER_TIME_STAMP AGGREGATED_auc_values AGGREGATED_X AGGREGATED_Y  Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2016-01-15 11:00:00                99.542           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2016-01-15 11:00:00                34.291           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2016-01-15 11:00:00                22.296           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2016-01-15 11:00:01                97.332           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2016-01-15 11:00:01                36.783           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2016-01-15 11:00:01                25.970           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2016-01-15 11:00:02               104.054           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2016-01-15 11:00:02                42.027           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2016-01-15 11:00:02                27.141           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2016-01-15 11:00:03               104.749           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2016-01-15 11:00:03                39.400           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2016-01-15 11:00:03                26.702           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2016-01-15 11:00:04               103.642           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2016-01-15 11:00:04                41.445           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2016-01-15 11:00:04                28.518           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2016-01-15 11:00:05               100.172           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2016-01-15 11:00:05                28.005           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2016-01-15 11:00:05                21.359           NA           NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2016-01-15 11:00:06                    NA           -1           -1 -1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://qutang.dev" class="external-link"><img class="img-circle p-3" src="https://d33wubrfki0l68.cloudfront.net/8af2089476f179254b3bc9628e13f7d143acab42/8309e/images/avatar.jpg" height="40"><span> Qu Tang</span></a>, <a href="https://bouve.northeastern.edu/directory/dinesh-john/" class="external-link"><img class="img-circle p-3" src="https://banner2.kisspng.com/20180410/bbw/kisspng-avatar-user-medicine-surgery-patient-avatar-5acc9f7a7cb983.0104600115233596105109.jpg" height="40"><span> Dinesh John</span></a>, <a href="http://www.ccs.neu.edu/home/intille/" class="external-link"><img class="img-circle p-3" src="http://www.ccs.neu.edu/home/intille/intille-headshot-sm2.jpg" height="40"><span> Stephen Intille</span></a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

