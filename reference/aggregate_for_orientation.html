<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Aggregate over epoch to get estimated accelerometer orientation. — aggregate_for_orientation • MIMSunit</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Aggregate over epoch to get estimated accelerometer orientation. — aggregate_for_orientation" />
<meta property="og:description" content="aggregate_for_orientation returns a dataframe with accelerometer
orientations estimated by
Mizell,
2003 over each epoch (see compute_orientation). The epoch
start time will be used as timestamp in the first column." />


<meta name="robots" content="noindex">



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>
<script async="" defer="" src="https://buttons.github.io/buttons.js"></script>
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-38342303-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-38342303-3');
</script>



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MIMSunit</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.10.1.8000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Get Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mims_unit_from_files.html">Compute MIMS-unit from files</a>
    </li>
    <li>
      <a href="../articles/mims_unit_from_imported_data.html">Compute MIMS-unit from imported data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/datasets.html">Datasets</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Algorithm Walkthrough
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/conceptual_diagram.html">Step-by-step illustration</a>
    </li>
    <li>
      <a href="../articles/truncation_threshold.html">Deciding truncation threshold</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Performances
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cross_device_consistency.html">Cross device consistency</a>
    </li>
    <li>
      <a href="../articles/edge_cases.html">Performance under edge conditions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">API References</a>
</li>
<li>
  <a href="../news/index.html">Changelogs</a>
</li>
<li>
  <a href="../articles/faq.html">FAQs</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mhealthgroup/mimsunit">
    <span class="fa fa-lg fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregate over epoch to get estimated accelerometer orientation.</h1>
    <small class="dont-index">Source: <a href='https://github.com/mhealthgroup/MIMSunit/blob/master/R/aggregate_over_epoch.R'><code>R/aggregate_over_epoch.R</code></a></small>
    <div class="hidden name"><code>aggregate_for_orientation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>aggregate_for_orientation</code> returns a dataframe with accelerometer
orientations estimated by
<a href='https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=1241424'>Mizell,
2003</a> over each epoch (see <code><a href='compute_orientation.html'>compute_orientation</a></code>). The epoch
start time will be used as timestamp in the first column.</p>
    </div>

    <pre class="usage"><span class='fu'>aggregate_for_orientation</span><span class='op'>(</span>
  <span class='va'>df</span>,
  <span class='va'>epoch</span>,
  estimation_window <span class='op'>=</span> <span class='fl'>2</span>,
  unit <span class='op'>=</span> <span class='st'>"deg"</span>,
  st <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>dataframe. Input accelerometer data in mhealth format. First column
should be timestamps in POSIXt format.</p></td>
    </tr>
    <tr>
      <th>epoch</th>
      <td><p>string. Any format that is acceptable by argument <code>breaks</code>
in method <code><a href='https://rdrr.io/r/base/cut.POSIXt.html'>cut.POSIXt</a></code>.For example, "1 sec", "1 min", "5
secs", "10 mins".</p></td>
    </tr>
    <tr>
      <th>estimation_window</th>
      <td><p>number. Duration in seconds to be used to estimate
orientation within each epoch. Default is 2 (seconds), as suggested by
<a href='https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=1241424'>Mizell,
2003</a>.</p></td>
    </tr>
    <tr>
      <th>unit</th>
      <td><p>string. The unit of orientation angles. Can be "deg" (degree) or
"rad" (radian). Default is "deg".</p></td>
    </tr>
    <tr>
      <th>st</th>
      <td><p>character or POSIXct timestamp. An optional start time you can set to
force the epochs generated by referencing this start time. If it is NULL, the
function will use the first timestamp in the timestamp column as start time to
generate epochs. This is useful when you are processing a stream of data and
want to use a common start time for segmenting data. Default is NULL.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>dataframe. The returned dataframe will have the same format as input
  dataframe.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function accepts a dataframe (in mhealth accelerometer data format) and
computes the estimated acclerometer orientations (in x, y, and z angles) over
each fixed epoch. The returned dataframe will have the same format as input
dataframe, including four columns, and have the same datetime format as input
dataframe in the timestamp column. The orientation estimation method used in
the function is based on
<a href='https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=1241424'>Mizell,
2003</a>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>If <code>epoch</code> argument is not provided or is <code>NULL</code>, the
  function will treat the input dataframe as a single epoch.</p>
<p>If the number of samples in an epoch is less than 90<!-- %, the output -->
  would be NaN (invalid) for this epoch.</p>
    <h2 class="hasAnchor" id="how-is-it-used-in-mims-unit-algorithm-"><a class="anchor" href="#how-is-it-used-in-mims-unit-algorithm-"></a>How is it used in mims-unit algorithm?</h2>

    <p>This function is used in
  mims-unit algorithm after extrapolation (<code><a href='extrapolate.html'>extrapolate</a></code>). The
  extrapolated signal will be estimated to get orientation angles using this
  function.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='aggregate_for_mims.html'>aggregate_for_mims</a></code> for aggregating to get integrated
  values for each axis for each epoch.</p>
<p>Other aggregate functions: 
<code><a href='aggregate_for_mims.html'>aggregate_for_mims</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>  <span class='co'># Use sample input data</span>
  <span class='va'>df</span> <span class='op'>=</span> <span class='va'>sample_raw_accel_data</span>
  <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     HEADER_TIME_STAMP     X      Y      Z
#&gt; 1 2016-01-15 11:00:00 0.148 -0.438  0.016
#&gt; 2 2016-01-15 11:00:00 0.215 -0.418 -0.023
#&gt; 3 2016-01-15 11:00:00 0.266 -0.402 -0.012
#&gt; 4 2016-01-15 11:00:00 0.336 -0.430  0.012
#&gt; 5 2016-01-15 11:00:00 0.430 -0.320  0.000
#&gt; 6 2016-01-15 11:00:00 0.535 -0.258  0.004</div><div class='input'>
  <span class='co'># set epoch to 1 second and unit to degree</span>
  <span class='co'># last epoch does not have enough samples to estimate orientation angles.</span>
  <span class='fu'>aggregate_for_orientation</span><span class='op'>(</span><span class='va'>df</span>, epoch<span class='op'>=</span><span class='st'>'1 sec'</span>, unit<span class='op'>=</span><span class='st'>'deg'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     HEADER_TIME_STAMP X_ANGLE Y_ANGLE Z_ANGLE
#&gt; 1 2016-01-15 11:00:00     NaN     NaN     NaN
#&gt; 2 2016-01-15 11:00:01     NaN     NaN     NaN
#&gt; 3 2016-01-15 11:00:02     NaN     NaN     NaN
#&gt; 4 2016-01-15 11:00:03     NaN     NaN     NaN
#&gt; 5 2016-01-15 11:00:04     NaN     NaN     NaN
#&gt; 6 2016-01-15 11:00:05     NaN     NaN     NaN
#&gt; 7 2016-01-15 11:00:06     NaN     NaN     NaN</div><div class='input'>
  <span class='co'># set epoch to 2 seconds and unit to radian</span>
  <span class='co'># last epoch does not have enough samples to estimate orientation angles.</span>
  <span class='fu'>aggregate_for_orientation</span><span class='op'>(</span><span class='va'>df</span>, epoch<span class='op'>=</span><span class='st'>'2 sec'</span>, unit<span class='op'>=</span><span class='st'>'rad'</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     HEADER_TIME_STAMP   X_ANGLE  Y_ANGLE  Z_ANGLE
#&gt; 1 2016-01-15 11:00:00 0.2001082 1.551401 1.769937
#&gt; 2 2016-01-15 11:00:02 0.1908424 1.584946 1.761100
#&gt; 3 2016-01-15 11:00:04 0.1840464 1.604471 1.751666
#&gt; 4 2016-01-15 11:00:06       NaN      NaN      NaN</div><div class='input'>
  <span class='co'># epoch set to 2 seconds, and st set to be 1 second before the start time of the data</span>
  <span class='co'># so the first segment will only include data for 1 second, therefore the resulted</span>
  <span class='co'># aggregated value for the first segment will be -1 (invalid) because the</span>
  <span class='co'># samples are not enough. And the second segment starts from 11:00:01, instead</span>
  <span class='co'># of 11:00:01 as shown in prior example,</span>
  <span class='fu'>aggregate_for_orientation</span><span class='op'>(</span><span class='va'>df</span>, epoch <span class='op'>=</span> <span class='st'>'1 sec'</span>, unit<span class='op'>=</span><span class='st'>'rad'</span>, st<span class='op'>=</span><span class='va'>df</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     HEADER_TIME_STAMP X_ANGLE Y_ANGLE Z_ANGLE
#&gt; 1 2016-01-15 11:00:00     NaN     NaN     NaN
#&gt; 2 2016-01-15 11:00:01     NaN     NaN     NaN
#&gt; 3 2016-01-15 11:00:02     NaN     NaN     NaN
#&gt; 4 2016-01-15 11:00:03     NaN     NaN     NaN
#&gt; 5 2016-01-15 11:00:04     NaN     NaN     NaN
#&gt; 6 2016-01-15 11:00:05     NaN     NaN     NaN
#&gt; 7 2016-01-15 11:00:06     NaN     NaN     NaN</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://qutang.dev'><img class='img-circle p-3' src="https://d33wubrfki0l68.cloudfront.net/8af2089476f179254b3bc9628e13f7d143acab42/8309e/images/avatar.jpg" height="40" /><span> Qu Tang</span></a>, <a href='https://bouve.northeastern.edu/directory/dinesh-john/'><img class='img-circle p-3' src="https://banner2.kisspng.com/20180410/bbw/kisspng-avatar-user-medicine-surgery-patient-avatar-5acc9f7a7cb983.0104600115233596105109.jpg" height="40" /><span> Dinesh John</span></a>, <a href='http://www.ccs.neu.edu/home/intille/'><img class='img-circle p-3' src="http://www.ccs.neu.edu/home/intille/intille-headshot-sm2.jpg" height="40" /><span> Stephen Intille</span></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


